# Story 011.01: Remove @vue/reactivity from Core Package

## Status

Draft

## Story

**As a** developer using useTemporal in any JavaScript framework,
**I want** the core package to have zero framework dependencies,
**so that** I only bundle the code I need without being forced to include Vue's reactivity system.

## Acceptance Criteria

1. Remove `@vue/reactivity` dependency from `packages/usetemporal/package.json`
2. Remove all reactive `Ref` imports and usage from core package source code
3. Remove `createTemporal` function export from core package
4. Remove `usePeriod` composable export from core package
5. Update all core operations to work with plain JavaScript objects (no Vue Refs)
6. All existing tests pass with modifications for non-reactive types
7. Core package has ZERO dependencies on any framework or reactivity system
8. Bundle size analysis shows reduction in core package size
9. Type definitions export only plain types (no `Ref<T>` types)
10. Package exports map updated to remove reactive entry points

## Tasks / Subtasks

- [ ] Remove @vue/reactivity dependency (AC: 1)
  - [ ] Remove from `package.json` dependencies
  - [ ] Run `npm install` to update lock file
  - [ ] Verify no other packages accidentally pull it in

- [ ] Update Temporal interface and types (AC: 2, 5, 9)
  - [ ] Remove `Temporal` interface from core (it was Vue-specific)
  - [ ] Remove all `Ref<Period>` types from type definitions
  - [ ] Update Period type to be plain object
  - [ ] Remove any reactive utility types

- [ ] Remove createTemporal from core (AC: 3)
  - [ ] Delete or move `createTemporal.ts` implementation
  - [ ] Remove export from `src/index.ts`
  - [ ] Update package.json exports map

- [ ] Remove usePeriod composable (AC: 4)
  - [ ] Delete or move `composables/usePeriod.ts`
  - [ ] Remove composables directory if empty
  - [ ] Remove export from `src/index.ts`
  - [ ] Update package.json exports map

- [ ] Update core operations (AC: 5)
  - [ ] Review all operation files for Ref usage
  - [ ] Replace any `Ref<Period>` with plain `Period`
  - [ ] Ensure operations work with plain objects
  - [ ] Remove any reactive utilities (computed, watch, etc.)

- [ ] Update tests (AC: 6)
  - [ ] Modify tests that expected reactive refs
  - [ ] Update test assertions for plain objects
  - [ ] Verify multi-adapter tests still pass
  - [ ] Run full test suite: `TZ=UTC npm test`

- [ ] Verify package.json configuration (AC: 7, 10)
  - [ ] Confirm dependencies section has no @vue/reactivity
  - [ ] Update exports map to remove `/composables` entry
  - [ ] Verify `sideEffects: false` is still correct
  - [ ] Check that no dev dependencies are framework-specific

- [ ] Bundle size validation (AC: 8)
  - [ ] Build the package: `npm run build`
  - [ ] Measure bundle size before/after
  - [ ] Document size reduction
  - [ ] Verify tree-shaking still works

- [ ] Documentation cleanup
  - [ ] Remove references to createTemporal in core docs
  - [ ] Remove references to usePeriod in core docs
  - [ ] Update README to focus on pure functions
  - [ ] Add note about framework packages (Vue/React coming)

## Dev Notes

### Current Architecture Context

The core package currently has Vue reactivity mixed in at multiple levels:

**Key Files to Modify:**
- `packages/usetemporal/package.json` - Remove dependency
- `packages/usetemporal/src/index.ts` - Remove exports
- `packages/usetemporal/src/createTemporal.ts` - Remove or relocate
- `packages/usetemporal/src/composables/usePeriod.ts` - Remove or relocate
- `packages/usetemporal/src/types.ts` - Remove Ref types

**Current Temporal Interface (TO BE REMOVED):**
```typescript
interface Temporal {
  adapter: Adapter
  weekStartsOn: number
  browsing: Ref<Period>  // Vue Ref - REMOVE
  now: Ref<Period>       // Vue Ref - REMOVE
}
```

**After this story, core exports ONLY:**
- Pure operations: `period`, `divide`, `next`, `previous`, `go`, `contains`, `isSame`, `merge`, `split`
- Adapters: `createNativeAdapter`, date-fns, luxon, temporal
- Types: `Period`, `Adapter`, `Unit` (all plain types)
- Calendar operations: `stableMonth`, `stableYear`

### Important Constraints

1. **weekStartsOn is an adapter setting** - It lives in adapter configuration, not in a Temporal object
2. **No breaking changes to pure functions** - Operations like `period()`, `divide()` should continue working exactly as before
3. **Preserve adapter interface** - The `Adapter` interface must remain unchanged
4. **Keep all existing tests** - Modify test expectations but preserve test coverage

### Migration Notes for Future Framework Packages

The removed code will be reimplemented in `@allystudio/usetemporal-vue`:
- `createTemporal` → `useTemporal` (Vue composable)
- `usePeriod` → stays as `usePeriod` (Vue composable)
- Both will use `@vue/reactivity` in the Vue package

### Testing

**Test Location:** Tests are colocated with source files (`*.test.ts`)

**Test Standards:**
- Use Vitest for all tests
- Multi-adapter testing pattern (test against all adapters)
- CRITICAL: Set `TZ=UTC` before running tests
  ```bash
  export TZ=UTC
  npm test
  ```

**Test Files to Update:**
- Any tests importing `createTemporal` or `usePeriod` from core
- Tests expecting `Ref<Period>` types
- Integration tests that use reactive state

**Testing Requirements:**
- All 722 tests must pass (or be updated appropriately)
- Coverage must remain ≥87%
- No new type errors introduced
- Build must succeed: `npm run build`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-24 | 1.0 | Story created from Epic 011 | Sarah (PO) |

## Dev Agent Record

### Agent Model Used

_To be filled by dev agent_

### Debug Log References

_To be filled by dev agent_

### Completion Notes

_To be filled by dev agent_

### File List

_To be filled by dev agent_

## QA Results

_To be filled by QA agent_
