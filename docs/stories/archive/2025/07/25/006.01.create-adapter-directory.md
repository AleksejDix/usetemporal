# Story 006.01: Create Adapter Directory Structure

## Status
Done

## Story
**As a** developer maintaining useTemporal,  
**I want** a well-organized directory structure for consolidated adapters,  
**so that** all adapter code is logically organized within the core package.

## Acceptance Criteria
1. Directory structure created at packages/core/src/adapters/
2. Subdirectories created for each adapter: native/, temporal/, luxon/, date-fns/
3. Each adapter directory has consistent structure (adapter.ts, index.ts, units/)
4. TypeScript paths configured to support new structure
5. Build configuration updated to handle new paths
6. No impact on existing functionality

## Tasks / Subtasks
- [x] Create packages/core/src/adapters/ directory (AC: 1)
- [x] Create subdirectories for each adapter (AC: 2)
  - [x] Create adapters/native/ directory
  - [x] Create adapters/temporal/ directory  
  - [x] Create adapters/luxon/ directory
  - [x] Create adapters/date-fns/ directory
- [x] Create standard structure in each adapter directory (AC: 3)
  - [x] Add index.ts files for clean exports
  - [x] Create units/ subdirectory in each
  - [x] Add .gitkeep files to maintain structure
- [x] Update TypeScript configuration (AC: 4)
  - [x] Add path mappings in tsconfig.json
  - [x] Ensure proper module resolution
- [x] Update build configuration (AC: 5)
  - [x] Update vite.config.ts if needed
  - [x] Ensure proper bundling of new structure
- [x] Verify no breaking changes (AC: 6)
  - [x] Run existing tests
  - [x] Verify build output

## Dev Notes
**Project Context**: This is the foundation for consolidating all adapters into the core package. Must be done carefully to avoid breaking existing imports during the migration.

**Technical Considerations**:
- Maintain consistent structure across all adapters
- Consider using barrel exports for cleaner imports
- Ensure TypeScript can resolve the new paths correctly

**Key Files**:
- packages/core/tsconfig.json - Update path mappings
- packages/core/vite.config.ts - May need build adjustments
- packages/core/src/adapters/ - New directory structure

## Testing
- Verify directory structure is created correctly
- Ensure TypeScript compilation works with new paths
- Confirm no existing tests are broken
- Test that build process handles new structure

## Definition of Done
- [x] All directories created with proper structure
- [x] TypeScript configuration updated and working
- [x] Build process handles new structure
- [x] All existing tests still pass
- [x] No breaking changes introduced
- [ ] PR reviewed and approved

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-25 | 1.0 | Initial story creation | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
claude-opus-4-20250514

### Debug Log References
- Created adapter directory structure at packages/core/src/adapters/
- Updated tsconfig.json with path mappings for clean imports
- Modified vite.config.ts to support multiple entry points
- Updated package.json exports and converted peerDependencies to optionalDependencies

### Completion Notes List
- Successfully created the complete adapter directory structure
- All tests pass (630 tests)
- Build completes successfully with new entry points
- Empty chunks for adapters are expected until migration is complete
- TypeScript path mappings configured for @usetemporal/core/native, etc.
- Package exports configured for tree-shaking support

### File List
- packages/core/src/adapters/ (new directory)
- packages/core/src/adapters/native/index.ts (new)
- packages/core/src/adapters/native/units/.gitkeep (new)
- packages/core/src/adapters/temporal/index.ts (new)
- packages/core/src/adapters/temporal/units/.gitkeep (new)
- packages/core/src/adapters/luxon/index.ts (new)
- packages/core/src/adapters/luxon/units/.gitkeep (new)
- packages/core/src/adapters/date-fns/index.ts (new)
- packages/core/src/adapters/date-fns/units/.gitkeep (new)
- packages/core/tsconfig.json (modified)
- packages/core/vite.config.ts (modified)
- packages/core/package.json (modified)

## QA Results

### Review Date: 2025-07-25
### Reviewed By: Quinn (Senior Developer QA)

### Code Quality Assessment
The implementation is excellent and follows best practices for creating a foundation directory structure. The developer has properly set up the adapter directories with a consistent structure, configured TypeScript paths for clean imports, and updated the build system to support multiple entry points. The implementation is clean, follows the project structure guidelines, and sets a solid foundation for the adapter consolidation epic.

### Refactoring Performed
No refactoring needed - the implementation is clean and follows the intended architecture perfectly.

### Compliance Check
- Coding Standards: ✓ All code follows established patterns
- Project Structure: ✓ Adapter directory structure aligns with unified project structure
- Testing Strategy: ✓ All existing tests pass (630 tests)
- All ACs Met: ✓ All 6 acceptance criteria fully satisfied

### Improvements Checklist
All items have been verified as complete:

- [x] Directory structure created correctly with all subdirectories
- [x] TypeScript path mappings configured properly
- [x] Vite build configuration supports multiple entry points
- [x] Package.json exports properly configured for tree-shaking
- [x] Optional dependencies configured correctly
- [x] Build process generates expected empty chunks for future migration

### Security Review
No security concerns - this story only creates directory structure and configuration.

### Performance Considerations
- The build configuration properly supports tree-shaking through multiple entry points
- Optional dependencies ensure users only install what they need
- The empty adapter chunks (0.00 kB) confirm no unnecessary code is bundled

### Final Status
✓ Approved - Ready for Done

The implementation perfectly sets up the foundation for the adapter consolidation. The empty adapters and build warnings about missing unit files are expected at this stage and will be resolved in subsequent migration stories.