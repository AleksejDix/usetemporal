# Story 011.04: Update Core Package Exports

## Status

Draft

## Story

**As a** developer using the core useTemporal package,
**I want** clean exports that only include pure functions and adapters,
**so that** I have a minimal, framework-agnostic API surface.

## Acceptance Criteria

1. Remove all Vue-related exports from `src/index.ts`
2. Remove `createTemporal` export
3. Remove `usePeriod` export
4. Remove `/composables` from package.json exports map
5. Export only pure operations (period, divide, next, etc.)
6. Export only adapters (native, date-fns, luxon, temporal)
7. Export only plain types (no Ref types)
8. Update package.json description to emphasize framework-agnostic nature
9. All core tests pass (after updating for non-reactive API)
10. Type check passes with zero errors
11. Build succeeds and generates correct type definitions
12. Bundle size is reduced compared to alpha.1

## Tasks / Subtasks

- [ ] Update src/index.ts main exports (AC: 1, 2, 3, 5, 6, 7)
  - [ ] Remove `export { createTemporal }` line
  - [ ] Remove `export { usePeriod }` line
  - [ ] Remove any other Vue-specific exports
  - [ ] Ensure all pure operations are exported
  - [ ] Ensure all adapters are exported
  - [ ] Ensure all plain types are exported

- [ ] Update package.json exports map (AC: 4)
  - [ ] Remove "./composables" entry
  - [ ] Keep "./operations" entry
  - [ ] Keep "./calendar" entry
  - [ ] Keep adapter entries (./native, ./luxon, etc.)
  - [ ] Keep "./types" entry
  - [ ] Verify main "." entry points to correct file

- [ ] Update package.json metadata (AC: 8)
  - [ ] Update description: "Framework-agnostic time library with pure functional operations"
  - [ ] Update keywords: remove 'vue', 'composable', keep 'functional', 'typescript'
  - [ ] Verify dependencies section has NO @vue/reactivity

- [ ] Update core tests (AC: 9)
  - [ ] Find all tests importing createTemporal from core
  - [ ] Update to use pure operations directly
  - [ ] Find all tests importing usePeriod from core
  - [ ] Update to use plain Period objects
  - [ ] Remove any tests for reactive behavior (moved to vue package)
  - [ ] Run: `TZ=UTC npm test --workspace=@allystudio/usetemporal`

- [ ] Type checking (AC: 10)
  - [ ] Run `npm run type-check --workspace=@allystudio/usetemporal`
  - [ ] Fix any type errors from removed exports
  - [ ] Ensure no Ref types leak into exports
  - [ ] Verify Adapter, Period, Unit types are properly exported

- [ ] Build verification (AC: 11)
  - [ ] Run `npm run build --workspace=@allystudio/usetemporal`
  - [ ] Verify dist/ contains only pure function code
  - [ ] Check generated type definitions (.d.ts files)
  - [ ] Ensure no Vue types in generated definitions

- [ ] Bundle size analysis (AC: 12)
  - [ ] Measure bundle size before changes (from alpha.1 baseline)
  - [ ] Measure bundle size after changes
  - [ ] Document size reduction
  - [ ] Target: ≤8KB gzipped for core

- [ ] Documentation cleanup
  - [ ] Update README.md to show pure function usage
  - [ ] Add note about framework packages
  - [ ] Remove examples showing createTemporal/usePeriod
  - [ ] Add link to @allystudio/usetemporal-vue for Vue users

## Dev Notes

### Current State (Before)

**src/index.ts exports (alpha.1):**
```typescript
// Operations
export * from './operations'

// Vue reactivity (TO BE REMOVED)
export { createTemporal } from './createTemporal'
export { usePeriod } from './composables/usePeriod'

// Adapters
export { createNativeAdapter } from './native'
// ... other adapters

// Types
export type { Period, Adapter, Unit } from './types'
export type { Temporal } from './createTemporal'  // ← Reactive type, remove
```

### Target State (After)

**src/index.ts exports (v2.0.0):**
```typescript
// Operations - pure functions only
export * from './operations'

// Adapters
export { createNativeAdapter } from './native'
export { createDateFnsAdapter } from './date-fns'
export { createLuxonAdapter } from './luxon'
export { createTemporalAdapter } from './temporal'

// Calendar operations
export { stableMonth, stableYear } from './calendar'

// Types - plain types only
export type { Period, Adapter, Unit } from './types'
export type { AdapterUnit } from './adapters/types'

// NO createTemporal
// NO usePeriod
// NO Temporal interface
// NO Vue reactivity
```

### package.json exports (Before)

```json
{
  "exports": {
    ".": {
      "types": "./dist/index.d.ts",
      "import": "./dist/index.js"
    },
    "./operations": {
      "types": "./dist/operations.d.ts",
      "import": "./dist/operations.js"
    },
    "./composables": {  // ← REMOVE THIS
      "types": "./dist/composables/index.d.ts",
      "import": "./dist/composables/index.js"
    },
    "./native": { ... },
    "./calendar": { ... }
  }
}
```

### package.json exports (After)

```json
{
  "exports": {
    ".": {
      "types": "./dist/index.d.ts",
      "import": "./dist/index.js"
    },
    "./operations": {
      "types": "./dist/operations.d.ts",
      "import": "./dist/operations.js"
    },
    "./native": { ... },
    "./date-fns": { ... },
    "./luxon": { ... },
    "./temporal": { ... },
    "./calendar": { ... },
    "./types": {
      "types": "./dist/types.d.ts"
    }
  }
}
```

### Tests to Update

Tests that currently do this:
```typescript
import { createTemporal } from '@allystudio/usetemporal'
```

Should be updated to:
```typescript
import { period, divide } from '@allystudio/usetemporal/operations'
import { createNativeAdapter } from '@allystudio/usetemporal/native'

const adapter = createNativeAdapter()
const month = period(adapter, new Date(), 'month')
```

### Testing

**Test Standards:**
- All tests must use pure functions
- No reactive refs in core tests
- Multi-adapter testing pattern maintained
- Coverage ≥87%

**Run tests:**
```bash
export TZ=UTC
npm test --workspace=@allystudio/usetemporal
npm run type-check --workspace=@allystudio/usetemporal
npm run build --workspace=@allystudio/usetemporal
```

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-24 | 1.0 | Story created from Epic 011 | Sarah (PO) |

## Dev Agent Record

### Agent Model Used

_To be filled by dev agent_

### Debug Log References

_To be filled by dev agent_

### Completion Notes

_To be filled by dev agent_

### File List

_To be filled by dev agent_

## QA Results

_To be filled by QA agent_
